# Audiochangerr Configuration Example
# Copy to config.yaml and customize

config_version: 1  # Optional: Config format version (currently v1)

# Required: Plex server connection
plex_server_url: "http://192.168.1.100:32400"  # Your Plex server URL
plex_token: "YOUR_PLEX_TOKEN_HERE"             # Get from Plex Web XML
owner_username: "your-plex-username"           # Server owner (processes owner + managed users)

mode: "polling"  # "polling" or "webhook"
dry_run: true    # true = test mode, false = apply changes

validation_timeout_seconds: 120  # Time to wait for session restart validation

# File Logging (optional)
# Outputs logs to files with automatic rotation
# Disabled by default - logs go to console only
# logging:
#   enabled: true              # Enable file logging
#   directory: "/logs"         # Log directory (created if missing)
#   max_size: "20m"            # Max file size before rotation (e.g., 20m, 100k, 1g)
#   max_files: "14d"           # Retention: "14d" = 14 days, "10" = 10 files
#   level: "info"              # File log level: error, warn, info, debug

# Polling mode (only used when mode: "polling")
check_interval: 10  # Seconds between checks

# Webhook mode (only used when mode: "webhook")
webhook:
  port: 4444            # HTTP server port
  host: "0.0.0.0"       # Bind address (0.0.0.0 = all interfaces)
  path: "/webhook"      # Webhook endpoint path
  secret: ""            # Optional: require X-Webhook-Secret header
  initial_delay_ms: 0   # Optional: delay before first session lookup
  session_retry:        # Optional: retry if session not found immediately
    max_attempts: 3           # Number of lookup attempts
    initial_delay_ms: 500     # Base delay for exponential backoff

# Audio selection rules (processed top to bottom, first match wins)
audio_selector:
  # Example 1: Prefer AC3 5.1 in original language, exclude commentary
  - codec: "ac3"
    channels: 6
    language: "original"
    keywords_exclude: ["Commentary", "Director"]

  # Example 2: Fallback to AAC stereo in original language
  - codec: "aac"
    channels: 2
    language: "original"

  # Example 3: DTS-HD Master Audio (if available)
  - codec: "dts-hd"
    channels: 6
    language: "original"
    keywords_include: ["MA", "Master"]

  # Example 4: English AC3 5.1 as secondary choice
  - codec: "ac3"
    channels: 6
    language: "eng"

  # Example 5: Any compatible stereo track
  - channels: 2

# Rule options:
# - codec: aac, ac3, eac3, dts, dts-hd, truehd, flac, mp3, opus, vorbis, pcm
# - channels: minimum 1-8 (>= match, e.g., 6 matches 6ch or 8ch)
# - language: "original" or ISO 639-2/3 code (eng, jpn, spa, fre, ger, etc.)
# - keywords_include: Array of keywords (must match ANY)
# - keywords_exclude: Array of keywords (must match NONE)
