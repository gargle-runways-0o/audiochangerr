# Audiochangerr Configuration Example
# Copy to config.yaml and customize
# Full reference: docs/CONFIGURATION.md

config_version: 1

# --- PLEX SERVER CONNECTION ---
plex_server_url: "http://192.168.1.100:32400"
owner_username: "your-plex-username"

# --- AUTHENTICATION ---
auth_method: "pin"  # "pin" (recommended), "token" (legacy), or "env"
# plex_token: "YOUR_TOKEN"  # Required if auth_method: "token"

# --- EXECUTION ---
mode: "polling"       # "polling" or "webhook"
dry_run: true         # true = log only, false = apply changes
terminate_stream: true  # Terminate session to restart playback

# --- TIMEOUTS (SECONDS) ---
validation_timeout_seconds: 120  # Max wait for session restart after track switch
plex_api_timeout_seconds: 30     # Plex API request timeout
graceful_shutdown_seconds: 30    # Time to finish processing before shutdown

# --- CONSOLE LOGGING ---
console:
  enabled: true      # Enable console output (true/false)
  level: "info"      # error, warn, info, or debug

# --- FILE LOGGING (OPTIONAL) ---
# logging:
#   enabled: true
#   directory: "/logs"
#   max_size: "20m"
#   max_files: "14d"
#   level: "info"

# --- POLLING MODE ---
check_interval: 10  # Seconds between session checks

# --- WEBHOOK MODE ---
webhook:
  port: 4444
  host: "0.0.0.0"
  path: "/webhook"
  local_only: true
  allowed_networks:
    - "127.0.0.0/8"      # Localhost
    - "192.168.0.0/16"   # Private network (Class C)
    - "10.0.0.0/8"       # Private network (Class A)
    - "172.16.0.0/12"    # Private network (Class B)
    - "::1/128"          # IPv6 localhost
  secret: ""             # Optional webhook secret (Tautulli only)
  initial_delay_ms: 0
  session_retry:
    max_attempts: 3
    initial_delay_ms: 500

# --- PRE-SELECTION (OPTIONAL) ---
pre_selection:
  enabled: false
  libraries: [] # Empty list = all libraries, or specify names e.g. ["Movies", "TV Shows"]

# --- AUDIO SELECTION RULES (FIRST MATCH WINS) ---
audio_selector:
  # AC3 5.1 original language, no commentary
  - codec: "ac3"
    channels: 6
    language: "original"
    keywords_exclude: ["Commentary", "Director"]

  # AAC stereo fallback
  - codec: "aac"
    channels: 2
    language: "original"

  # DTS-HD Master Audio
  - codec: "dts-hd"
    channels: 6
    language: "original"
    keywords_include: ["MA", "Master"]

  # English AC3 5.1
  - codec: "ac3"
    channels: 6
    language: "eng"

  # Any stereo track
  - codec: "aac"
    channels: 2
